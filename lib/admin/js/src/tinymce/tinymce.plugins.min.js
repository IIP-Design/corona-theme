var form_base={width:500,height:220,editor:null,cacheReqs:{},debug:function(msg){if(console){if(_.isObject(msg)){console.dir(msg)}else{console.log(msg)}}},addShortcodeToEditor:function(data){var sc=this.shortcodeName.value.replace("_","-"),content="["+sc,value;this.debug(data);$.each(data,function(name){value=data[name];if(_.isBoolean(value)){value=+value}content+=" "+name+'="'+value+'"'});content+="][/"+sc+"]";return content},ajax:function(func){return jQuery.ajax({type:"post",context:this,url:ajaxVars.url,dataType:"json",data:{action:func,security:ajaxVars.tinymceNonce}})},open:function(){if(this.action){if(this.cacheReqs[name]){this.openFormWindow(this.cacheReqs[name])}else{this.ajax(this.action).done(function(data){this.cacheReqs[name]=data;this.openFormWindow(data)}).fail(function(err){this.debug(err)})}}else{this.openFormWindow({})}},openFormWindow:function(data){var self=this;var args={title:"Add "+this.shortcodeName.text,body:this.getFields(data),width:this.width,height:this.height,onsubmit:function(e){tinyMCE.activeEditor.selection.setContent(self.addShortcodeToEditor(e.data))}};this.editor.windowManager.open(args)}};var form_cta=Object.create(window["form_base"]);form_cta.getFields=function(data){var fields=[{type:"container",layout:"flex",items:[{type:"button",text:"Select image",onclick:function(){window.mb=window.mb||{};window.mb.frame=wp.media({frame:"post",state:"insert",library:{type:"image"},multiple:false});window.mb.frame.on("insert",function(){var json=window.mb.frame.state().get("selection").first().toJSON();if(0>jQuery.trim(json.url.length)){return}jQuery("#image_id").val(json.id)});window.mb.frame.open()}},{type:"textbox",name:"image_id",label:"Image ID",id:"image_id",value:"",style:"width: 60px; margin-left: 15px"}]},{type:"textbox",name:"text",label:"Text"},{type:"checkbox",name:"button",label:"Show button"},{type:"textbox",name:"button_link",label:"Button link"},{type:"textbox",name:"button_label",label:"Button label"}];return fields};var $=tinymce.dom.DomQuery;var form_post_list=Object.create(window["form_base"]);form_post_list.height=430;form_post_list.action="fetch_data_post_list";form_post_list.getFields=function(data){var self=this;var fields=[{type:"form",padding:0,items:[{type:"listbox",values:this.getCategories(data.categories),label:"Category;",name:"posts_cat",text:"All Categories"},{type:"textbox",label:"Number of posts to show:",name:"posts_num",maxWidth:70,onPostRender:function(e){self.numbersOnly(e.target)}},{type:"checkbox",name:"show_image",label:"Show image:"},{type:"listbox",id:"image_size",text:"",values:this.getImageSizes(data.image_sizes),label:"Image size:",name:"image_size"},{type:"listbox",text:"Center",values:this.getImageAlignment(),label:"Image alignment:",name:"image_alignment"},{type:"listbox",text:"Standard",values:this.getPostFormats(data.post_formats[0]),label:"Post format:",name:"post_format"},{type:"checkbox",name:"show_title",label:"Show post title:"},{type:"listbox",text:"Excerpt",values:this.getContentFormat(),label:"Content to show:",name:"show_content"},{type:"textbox",label:"Number of words:",maxWidth:70,name:"content_limit",onPostRender:function(e){self.numbersOnly(e.target)}},{type:"checkbox",name:"more_text_from_post",label:"Show more text link:"},{type:"textbox",label:"More text:",name:"more_text"}]}];return fields};form_post_list.numbersOnly=function(obj){var el=obj.getEl();$(el).attr("type","number");$(el).attr("min","0")};form_post_list.getImageAlignment=function(){return[{text:"Center",value:"center"},{text:"Left",value:"left"},{text:"Right",value:"right"}]};form_post_list.getContentFormat=function(){return[{text:"Excerpt",value:"excerpt"},{text:"Content",value:"content"},{text:"Content with word limit",value:"content-limit"}]};form_post_list.getImageSizes=function(data){var result=_.map(data,function(obj,index){return{text:index,value:index}});return result};form_post_list.getPostFormats=function(data){var result=_.map(data,function(str){return{text:str.charAt(0).toUpperCase()+str.substr(1),value:str}});result.unshift({text:"Standard",value:"standard"});return result};form_post_list.getCategories=function(data){var result=_.map(data,function(obj){return{text:_.unescape(obj.cat_name),value:obj.cat_ID}});result.unshift({text:"All Categories",value:"all"});return result};(function($){tinymce.PluginManager.add("corona_shortcode_btns",function(editor){function getShortcodeName(e){var shortcodeName={};if(e.control&&e.control.state){shortcodeName=e.control.state.data}return shortcodeName}function getListofMenuItemsWrittenIntoFooter(){var shList=[];$.each(menu,function(i){shList.push({text:menu[i],value:i})});return shList}function openShortcodeDialogue(e){var scn=getShortcodeName(e);var form=Object.create(window["form_"+scn.value]);form.shortcodeName=scn;form.editor=editor;form.open()}editor.addButton("corona_shortcode_btns",{type:"listbox",text:"Add Shortcode",values:getListofMenuItemsWrittenIntoFooter(),onselect:function(e){openShortcodeDialogue(e)}})})})(jQuery);
//# sourceMappingURL=./tinymce.plugins.min.js.map